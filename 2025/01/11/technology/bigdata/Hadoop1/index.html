<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Sabthever">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set data attribute for CSS variables
                root.setAttribute("data-theme", theme);
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes once DOM is ready
            if (document.readyState !== "loading") {
                document.body.classList.add(theme + "-mode");
            } else {
                document.addEventListener("DOMContentLoaded", () => {
                    document.body.classList.add(theme + "-mode");
                    document.body.classList.remove((theme === DARK ? LIGHT : DARK) + "-mode");
                });
            }
        })();
    </script>
    
    <!-- Critical CSS to prevent flash -->
    <style>
        :root[data-theme="dark"] {
            --background-color: #202124;
            --background-color-transparent: rgba(32, 33, 36, 0.6);
            --second-background-color: #2d2e32;
            --third-background-color: #34353a;
            --third-background-color-transparent: rgba(32, 33, 36, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #ffffff;
            --second-text-color: #eeeeee;
            --third-text-color: #bebec6;
            --fourth-text-color: #999999;
            --default-text-color: #bebec6;
            --invert-text-color: #373D3F;
            --border-color: rgba(255, 255, 255, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(255, 255, 255, 0.08);
            --shadow-color-2: rgba(255, 255, 255, 0.05);
        }
        
        :root[data-theme="light"] {
            --background-color: #fff;
            --background-color-transparent: rgba(255, 255, 255, 0.6);
            --second-background-color: #f8f8f8;
            --third-background-color: #f2f2f2;
            --third-background-color-transparent: rgba(241, 241, 241, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #16171a;
            --second-text-color: #2f3037;
            --third-text-color: #5e5e5e;
            --fourth-text-color: #eeeeee;
            --default-text-color: #373D3F;
            --invert-text-color: #bebec6;
            --border-color: rgba(0, 0, 0, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(0, 0, 0, 0.08);
            --shadow-color-2: rgba(0, 0, 0, 0.05);
        }
        
        body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
        
        /* Apply body classes as soon as DOM is ready */
        :root[data-theme="dark"] body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
    </style>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://sabthever.cn/2025/01/11/technology/bigdata/hadoop1/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据学习笔记1-Hadoop">
<meta property="og:url" content="https://sabthever.cn/2025/01/11/technology/bigdata/Hadoop1/index.html">
<meta property="og:site_name" content="Sabthever&#39;s Blog">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sabthever.cn/images/redefine-og.webp">
<meta property="article:published_time" content="2025-01-11T01:28:34.000Z">
<meta property="article:modified_time" content="2025-09-11T06:25:10.502Z">
<meta property="article:author" content="Sabthever">
<meta property="article:tag" content="Hadoop">
<meta property="article:tag" content="Bigdata">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sabthever.cn/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/%E5%A4%B4%E5%83%8F.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/%E5%A4%B4%E5%83%8F.jpg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/%E5%A4%B4%E5%83%8F.jpg">
    <!--- Page Info-->
    
    <title>
        
            大数据学习笔记1-Hadoop | Sabthever&#39;s Blog
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"sabthever.cn","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":false},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":true,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"side_tools":{"gear_rotation":true,"auto_expand":false},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Wecome to my blog!","subtitle":{"text":["Loading..."],"hitokoto":{"enable":true,"show_author":true,"api":"https://v1.hitokoto.cn?encode=utf-8&c=d&c=h&c=i&c=k&c=e"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":3000,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/Sabthever","instagram":null,"zhihu":null,"twitter":null,"email":"3175693234@qq.com"},"qrs":{"weixin":null,"fa-brands fa-qq":"/images/qq.jpg"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"},"mindmap":{"enable":true}},"version":"2.8.5","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-solid fa-house"},"说说":{"path":"/essays","icon":"fa-solid fa-message-dots"},"Archives":{"path":"/archives","icon":"fa-solid fa-archive"},"书签":{"icon":"fa-solid fa-bookmark","path":"/bookmarks/"},"相册":{"icon":"fa-solid fa-image","path":"/masonry/"},"About":{"icon":"fa-solid fa-user","path":"/about"}},"search":{"enable":true,"preload":true,"path":"search.xml","field":"post","content":true,"format":"html"}},"page_templates":{"friends_column":3,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"info","announcement":"域名变更。从即日起域名变更为https://www.sabthever.cn/ ，这个域名后期会长期使用。原域名https://www.sabthever.online/将会维护到2025-12-25，请保存新的地址。","show_on_mobile":true,"links":{"说说":{"icon":"fa-solid fa-message-dots","path":"/essays"},"书签":{"icon":"fa-solid fa-bookmark","path":"/bookmarks/"},"相册":{"icon":"fa-solid fa-image","path":"/masonry/"},"关于":{"icon":"fa-solid fa-user","path":"/about"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2024/12/18 15:27:14"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Sabthever&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-solid fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/essays"
                                        >
                                    <i class="fa-solid fa-message-dots fa-fw"></i>
                                    说说
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-solid fa-archive fa-fw"></i>
                                    归档
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/bookmarks/"
                                        >
                                    <i class="fa-solid fa-bookmark fa-fw"></i>
                                    书签
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/masonry/"
                                        >
                                    <i class="fa-solid fa-image fa-fw"></i>
                                    相册
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/about"
                                        >
                                    <i class="fa-solid fa-user fa-fw"></i>
                                    关于
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-solid fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/essays"
                        >
                            <span>
                                说说
                            </span>
                            
                                <i class="fa-solid fa-message-dots fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                归档
                            </span>
                            
                                <i class="fa-solid fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/bookmarks/"
                        >
                            <span>
                                书签
                            </span>
                            
                                <i class="fa-solid fa-bookmark fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/masonry/"
                        >
                            <span>
                                相册
                            </span>
                            
                                <i class="fa-solid fa-image fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/about"
                        >
                            <span>
                                关于
                            </span>
                            
                                <i class="fa-solid fa-user fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
                
                    
                    
                    
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/about"
                        >
                            <span>关于</span>
                            <i class="fa-solid fa-user fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">36</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">7</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">33</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">大数据学习笔记1-Hadoop</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/%E5%A4%B4%E5%83%8F.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Sabthever</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-01-11 09:28:34</span>
        <span class="mobile">2025-01-11 09:28:34</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-09-11 14:25:10</span>
            <span class="mobile">2025-09-11 14:25:10</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Technology/">Technology</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/Technology/Bigdata/">Bigdata</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Hadoop/">Hadoop</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Bigdata/">Bigdata</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>11.1k 字</span>
        </span>
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="Hadoop1"><a href="#Hadoop1" class="headerlink" title="Hadoop1"></a>Hadoop1</h1><h2 id="一-前期"><a href="#一-前期" class="headerlink" title="一.前期"></a>一.前期</h2><ul>
<li><p>分布式系统架构，大小自己会扩展</p>
</li>
<li><p>发展及版本</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/2.png"
                     
                ></p>
<ul>
<li>Apache原始的，标准版，版本先进，免费，稳定性不足</li>
<li>我们这边用CDH，在原有Apache版本上封装了很多包，稳定性高于Apache版本，后来开始收费被Hortonworks收购。CDH老版本不收费。</li>
</ul>
</li>
<li><p>使用原因</p>
<ul>
<li><p>高扩展性</p>
<p>低成本服务器集群</p>
</li>
<li><p>高可靠性</p>
<p>默认三个副本</p>
</li>
<li><p>高容错性</p>
</li>
<li><p>低成本</p>
<p>针对海量数据</p>
</li>
<li><p>灵活，任意类型数据</p>
</li>
<li><p>开源</p>
</li>
</ul>
</li>
<li><p>和普通的对比</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/3.png"
                      style="zoom:80%;" 
                >
</li>
<li><p>Hadoop生态圈</p>
<ul>
<li><p>Hadoop核心</p>
<ul>
<li><p>HDFS、MapReduce、YARN</p>
<p>yarn调度服务 hdfs存储服务 mapreduce主要是分布式的计算</p>
</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/4.png"
                      style="zoom: 50%;" 
                >

<p>Hive、Zookeeper、数据迁移、spark</p>
<p>Sqoop：数据库取</p>
<p>Flume：半&#x2F;非结构化数据结构取</p>
<p>python中类似于springboot的架构：Django Flask FastAPI</p>
</li>
<li><p>Hadoop对内多线程，对外单线程</p>
</li>
<li><p>端口</p>
<p>8088 任务查看监控运行</p>
<p>50070 hdfs查看</p>
<p>9000 hdfs服务端口</p>
</li>
<li><p>存储的数据</p>
<ul>
<li>结构化数据： 格式化数据 表</li>
<li>半结构化数据：日志 文件</li>
<li>非结构化数据：图片 图</li>
</ul>
</li>
</ul>
<h2 id="二-Hadoop架构"><a href="#二-Hadoop架构" class="headerlink" title="二.Hadoop架构"></a>二.Hadoop架构</h2><ul>
<li><p>HDFS（Hadoop Distributed File System)</p>
<p>分布式文件系统，解决分布式存储</p>
</li>
<li><p>MapReduce</p>
<p>分布式计算框架</p>
</li>
<li><p>YARN</p>
<ul>
<li>分布式资源管理系统</li>
<li>在Hadoop 2.x中引入</li>
</ul>
</li>
</ul>
<h3 id="一-环境搭建"><a href="#一-环境搭建" class="headerlink" title="(一)环境搭建"></a>(一)<a class="link"   target="_blank" rel="noopener" href="https://github.com/Sabthever/Pictures1/blob/main/Download_Resources/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%89%E8%A3%85hadoop+zookeeper+hbase(%E5%8D%B7%E4%B8%80).doc" >环境搭建<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></h3><ul>
<li><p>hadoop+zookeeper+hbase</p>
</li>
<li><p>这边搭建CDH5.14.2 - Hadoop2.6.0</p>
</li>
<li><p>后期Apache Hadoop 3.1.3</p>
</li>
<li><p>单机   完整版</p>
</li>
<li><p>高可用分布式HA</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/5.png"
                      style="zoom: 100%;" 
                ></li>
</ul>
<h4 id="A-单机配置"><a href="#A-单机配置" class="headerlink" title="A.单机配置"></a>A.单机配置</h4><ol>
<li><p>布置好虚拟机基础配置（要jdk1.8）</p>
</li>
<li><p>把hadoop-2.6.0-cdh5.14.2.tar.gz放入&#x2F;opt</p>
</li>
<li><p>解压并且到相应文件夹中</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf hadoop-2.6.0-cdh5.14.2.tar.gz</span><br><span class="line"><span class="built_in">mv</span> hadoop-2.6.0-cdh5.14.2 soft/hadoop260</span><br><span class="line"><span class="built_in">cd</span> /opt/soft/hadoop260/etc/hadoop/</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>改文件</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim hadoop-env.sh</span></span><br><span class="line">改JAVA_HOME 为自己的路径比如：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/soft/jdk180</span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># vim core-site.xml 这个下面</span><br><span class="line">1.指定文件系统（记得改IP）</span><br><span class="line">2.指定存放目录</span><br><span class="line">3.指定hdfs的使用白名单(这边的所有的root组下的)</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://192.168.179.139:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/soft/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.users<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>往往两个副本在同一个机架上，另一个副本在远端</p>
<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># vim hdfs-site.xml</span><br><span class="line">副本数，这边1，后面要改（因为这边只用了单机）</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cp mapred-site.xml.template mapred-site.xml</span><br><span class="line">vim mapred-site.xml</span><br><span class="line">计算引擎框架叫yarn</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br><span class="line">资源管理器配置，自动管理资源</span><br><span class="line">主要配置shuffle</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Site specific YARN configuration properties --&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.localhost<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p><code>/etc/profile</code>中最后加上</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hadoop Env</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/soft/hadoop260 <span class="comment"># 这边要改jdk地址</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HDFS_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> YARN_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_LIB_NATIVE_DIR=<span class="variable">$HADOOP_HOME</span>/lib/native</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> HADOOP_INSTALL=<span class="variable">$HADOOP_HOME</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>密钥生成</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -P <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">cd</span> ~/.ssh/</span><br><span class="line">ssh-copy-id -i id_rsa.pub root@本机ip</span><br></pre></td></tr></table></figure></div>

<p>试一下</p>
<p><code>ssh hadoopstandalone</code>然后退出exit ，那个hadoopstandalone是之前改的主机名</p>
</li>
<li><p>格式化hdfs</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>启动集群</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh</span><br><span class="line"><span class="built_in">yes</span></span><br><span class="line"><span class="built_in">yes</span></span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stop-all.sh <span class="comment"># 关闭集群</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>查看是否成功</p>
<p><code>jps</code></p>
<p>除了jps外一共要5个</p>
<p>NameNode DataNode挂掉且配置没有问题的话，可以把tmp删了，把logs里面的东西删了，再重格式化一遍</p>
</li>
<li><p>从浏览器查看</p>
<p><a class="link"   target="_blank" rel="noopener" href="http://hadoop的ip地址:50070/" >地址<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
</li>
</ol>
<h5 id="使用和api"><a href="#使用和api" class="headerlink" title="使用和api"></a>使用和api</h5><ul>
<li>Linux中</li>
</ul>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -<span class="built_in">mkdir</span> /mydemo <span class="comment"># 建立一个文件夹</span></span><br><span class="line">hadoop fs -put /opt/abc.txt /mydemo <span class="comment"># 传文件</span></span><br><span class="line">hadoop fs -get /mydemo/abc.txt ~/.ssh/ <span class="comment"># 下载数据</span></span><br><span class="line">hadoop dfs -<span class="built_in">cat</span> /mydemo/abc.txt <span class="comment"># 查看文件</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>Java中</p>
<ul>
<li><p>pom.xml中依赖</p>
<p>版本要匹配</p>
<ul>
<li><p>hadoop common是工具包</p>
</li>
<li><p>hadoop client是客户端</p>
</li>
<li><p>Hadoop hdfs 记得删test</p>
</li>
</ul>
<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hadoop.version</span>&gt;</span>2.6.0<span class="tag">&lt;/<span class="name">hadoop.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-common --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-client --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-hdfs --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-hdfs<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure></div>
</li>
<li><p>Java中进行IO操作</p>
<ul>
<li><p>读操作</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> Exception</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 通过地址找到hdfs文件系统</span></span><br><span class="line">    <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://192.168.179.139:9000&quot;</span>)</span><br><span class="line">                                   , <span class="keyword">new</span> <span class="title class_">Configuration</span>());</span><br><span class="line">    <span class="comment">// 获取输入流</span></span><br><span class="line">    <span class="type">FSDataInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> fs.open(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/mydemo/abc&quot;</span>));</span><br><span class="line">    <span class="comment">// 查看流信息</span></span><br><span class="line">    String line=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> ((line = fis.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">        System.out.println(line);</span><br><span class="line">    &#125;</span><br><span class="line">    fis.close();</span><br><span class="line">    fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>写数据</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FSDataInputStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 通过地址找到hdfs文件系统</span></span><br><span class="line">        <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://192.168.179.139:9000&quot;</span>)</span><br><span class="line">                , <span class="keyword">new</span> <span class="title class_">Configuration</span>());</span><br><span class="line">        <span class="comment">// 获取输入流</span></span><br><span class="line">        <span class="type">FSDataInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> fs.open(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/mydemo/abc&quot;</span>));</span><br><span class="line">        <span class="comment">// 准备一个写入流</span></span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;d:/d.txt&quot;</span>);</span><br><span class="line">        IOUtils.copyBytes(fis,fos,<span class="number">4096</span>,<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="B-高可用hadoop集群搭建"><a href="#B-高可用hadoop集群搭建" class="headerlink" title="B.高可用hadoop集群搭建"></a>B.<a class="link"   target="_blank" rel="noopener" href="https://github.com/Sabthever/Pictures1/blob/main/Download_Resources/%E9%AB%98%E5%8F%AF%E7%94%A8hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.pdf" >高可用hadoop集群搭建<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></h4><h5 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h5><ol>
<li><p>安装3台centos7 服务器</p>
</li>
<li><p>配置名字hd01\hd02\hd03</p>
</li>
<li><p>配置网络static</p>
</li>
<li><p>关闭防火墙</p>
</li>
<li><p>hd01可以访问hd02、hd03（同理其他都可互相访问）</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 三个都要</span></span><br><span class="line"><span class="comment">#hd01 做ssh 公私钥 无秘</span></span><br><span class="line">ssh-keygen -t rsa -P <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># copy 公钥到 hd02 hd03</span></span><br><span class="line">ssh-copy-id -i .ssh/id_rsa.pub root@ha01</span><br><span class="line">ssh-copy-id -i .ssh/id_rsa.pub root@ha02</span><br><span class="line">ssh-copy-id -i .ssh/id_rsa.pub root@ha03</span><br><span class="line"><span class="comment"># ssh-copy-id 192.168.192.201#hd02</span></span><br><span class="line"><span class="comment"># ssh-copy-id 192.168.192.202#hd03</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>所有服务器时间同步</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装chrony</span></span><br><span class="line">yum -y install chrony</span><br><span class="line"><span class="comment">#配置chrony</span></span><br><span class="line">vi /etc/chrony.conf</span><br><span class="line">server ntp1.aliyun.com</span><br><span class="line">server ntp2.aliyun.com</span><br><span class="line">server ntp3.aliyun.com</span><br><span class="line">注释掉server 0.centos.pool.ntp.org iburst</span><br><span class="line"><span class="comment">#启动chrony</span></span><br><span class="line">systemctl start chronyd</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>安装wget</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>安装psmisc(linux命令工具包 namenode主备切换时要用到 只需要安装在两个namenode节点上)(好像暂时不用，后面看看情况)</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y psmisc</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>修改源</p>
</li>
</ol>
<h5 id="集群部署"><a href="#集群部署" class="headerlink" title="集群部署"></a>集群部署</h5><ol>
<li><p>先配置zookeeper，只要一台为主</p>
<p>zookeeper的端口是2181</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这边的在第一台中</span></span><br><span class="line"><span class="comment"># 先把相应压缩包放到/opt</span></span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">tar -zxf zookeeper-3.4.5-cdh5.14.2.tar.gz</span><br><span class="line"><span class="built_in">mv</span> zookeeper-3.4.5-cdh5.14.2 soft/zk345</span><br><span class="line"><span class="built_in">cd</span> soft/zk345/conf/</span><br><span class="line"><span class="built_in">cp</span> zoo_sample.cfg zoo.cfg</span><br><span class="line"></span><br><span class="line"><span class="comment"># vim zoo.cfg</span></span><br><span class="line">dataDir=/opt/soft/zk345/data</span><br><span class="line">在最后一行加上</span><br><span class="line">server.1=192.168.179.141:2888:3888 <span class="comment"># 这两个端口可以改，前一个是互相通信的，后一个是选老大的</span></span><br><span class="line">server.2=192.168.179.142:2888:3888</span><br><span class="line">server.3=192.168.179.143:2888:3888</span><br><span class="line"><span class="comment"># 保存退出</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">mkdir</span> data</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span> &gt; data/myid</span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把/opt/soft/zk345拷贝到其他两个中</span></span><br><span class="line">scp -r zk345/ root@ha02:/opt/soft/</span><br><span class="line">scp -r zk345/ root@ha03:/opt/soft/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改/opt/soft/zk345/data/myid的id</span></span><br><span class="line">2号改2 3号改3</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>三个同时配置文件</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile最后加</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Zookeeper Env</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/soft/zk345</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br><span class="line"><span class="comment"># 保存退出</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>启动zookeeper</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br><span class="line">zkServer.sh stop <span class="comment"># 停止</span></span><br></pre></td></tr></table></figure></div>

<p>jps看一下</p>
<p>多一个QuorumPeerMain就是正确的</p>
</li>
<li><p>配置hadoop集群</p>
<ul>
<li><p>先在第一个中配置，把hadoop相应文件放到&#x2F;opt下</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">tar -zxf hadoop-2.6.0-cdh5.14.2.tar.gz</span><br><span class="line"><span class="built_in">mv</span> hadoop-2.6.0-cdh5.14.2 /opt/soft/hadoop260</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/soft/hadoop260/tmp</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/soft/hadoop260/dfs/journalnode_data</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/soft/hadoop260/dfs/edits</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/soft/hadoop260/dfs/datanode_data</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/soft/hadoop260/dfs/namenode_data</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /opt/soft/hadoop260/etc/hadoop</span><br><span class="line"><span class="comment"># vim hadoop-env.sh</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/soft/jdk180</span><br><span class="line"><span class="built_in">export</span> HADOOP_CONF_DIR=/opt/soft/hadoop260/etc/hadoop</span><br><span class="line"><span class="comment"># 保存退出</span></span><br></pre></td></tr></table></figure></div>

<p>vim core-site.xml 中文到时候删了 主机名记得改</p>
<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span> 集群的名字</span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定hadoop运行时产生的临时文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/soft/hadoop260/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--设置缓存大小 默认4KB，并行状态下每个文件都开就会很大--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定zookeeper的存放地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>ha.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:2181,ha02:2181,ha03:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--这个地方改名别忘了--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置允许root代理访问主机节点--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置该节点允许root用户所属的组--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>vim hdfs-site.xml 中文删了 主机名记得改</p>
<p>如果用固态硬盘128M就太小了，可以放大</p>
<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--数据块默认大小128M--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.block.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--副本数量 不配置默认为3--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namenode节点数据(元数据)的存放位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/soft/hadoop260/dfs/namenode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--datanode节点数据(元数据)的存放位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/soft/hadoop260/dfs/datanode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启hdfs的webui界面--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--datanode上负责进行文件操作的线程数--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.max.transfer.threads<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定hadoop集群在zookeeper上的注册名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--hacluster集群下有两个namenode分别是nn1,nn2--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.namenodes.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>nn1,nn2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--nn1的rpc、servicepc和http通讯地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--nn2的rpc、servicepc和http通讯地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha02:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha02:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha02:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定Namenode的元数据在JournalNode上存放的位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.shared.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>qjournal://ha01:8485;ha02:8485;ha03:8485/hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定JournalNode在本地磁盘的存储位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.journalnode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/soft/hadoop260/dfs/journalnode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定namenode操作日志存储位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/soft/hadoop260/dfs/edits<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启namenode故障转移自动切换--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.automatic-failover.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置失败自动切换实现方式--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.failover.proxy.provider.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置隔离机制--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.methods<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>sshfence<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置隔离机制需要SSH免密登录--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/.ssh/id_rsa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--hdfs文件操作权限 false为不验证--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.premissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">cp mapred-site.xml.template mapred-site.xml</span><br><span class="line">vim mapred-site.xml</span><br><span class="line">主机名记得改</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定mapreduce在yarn上运行--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置历史服务器地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置历史服务器webUI地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启uber模式--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>vim yarn-site.xml 中文记得删除</p>
<div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启yarn高可用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定Yarn集群在zookeeper上注册的节点名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.cluster-id<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hayarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定两个resourcemanager的名称--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.rm-ids<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>rm1,rm2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定rm1的主机--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha02<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定rm2的主机--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha03<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置zookeeper的地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.zk-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha01:2181,ha02:2181,ha03:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启yarn恢复机制--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.recovery.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置执行resourcemanager恢复机制实现类--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.store.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定主resourcemanager的地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>ha03<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--nodemanager获取数据的方式--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启日志聚集功能--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置日志保留7天--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>vim slaves 改为</p>
<div class="code-container" data-rel="Txt"><figure class="iseeu highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ha01</span><br><span class="line">ha02</span><br><span class="line">ha03</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>发送到其他两台机器中</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /opt/soft/hadoop260/ root@ha02:/opt/soft</span><br><span class="line">scp -r /opt/soft/hadoop260/ root@ha03:/opt/soft</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>好了以后，同时在三台设备中</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile</span></span><br><span class="line">在最后加上</span><br><span class="line"></span><br><span class="line"><span class="comment">#hadoop</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/soft/hadoop260</span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HDFS_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> YARN_HOME=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_LIB_NATIVE_DIR=<span class="variable">$HADOOP_HOME</span>/lib/native</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> HADOOP_INSTALL=<span class="variable">$HADOOP_HOME</span></span><br><span class="line"><span class="comment"># 保存退出</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></div></li>
</ul>
</li>
</ol>
<h5 id="启动集群"><a href="#启动集群" class="headerlink" title="启动集群"></a>启动集群</h5><ol>
<li><p>启动zookeeper(3个都启动)(前面启动了就不用了)</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>JournalNode(3个都启动)</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start journalnode</span><br><span class="line"><span class="comment"># jps查看一下 多一个JournalNode</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>格式化namenode(只在ha01主机上)</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>将ha01上的Namenode的元数据复制到ha02相同位置</p>
<p>这里面存储的是namenode的日志文件：fsimage_xxxx</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /opt/soft/hadoop260/dfs/namenode_data/current/ root@ha02:/opt/soft/hadoop260/dfs/namenode_data</span><br></pre></td></tr></table></figure></div>

<p>&#x2F;opt&#x2F;soft&#x2F;hadoop260&#x2F;dfs 中的edits是datanode的日志文件</p>
</li>
<li><p>在ha01或ha02格式化故障转移控制器zkfc(这边再ha01上)</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs zkfc -formatZK</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>在ha01上启动dfs服务</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/6.png"
                      style="zoom:80%;" 
                >
</li>
<li><p>在hd03上启动yarn服务(这都是之前配置好的)</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-yarn.sh</span><br></pre></td></tr></table></figure></div>

<p>多了ResourceManager</p>
<p>都多了NodeManager</p>
</li>
<li><p>在hd01上启动history服务器（不一定要）</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure></div>

<p>多了JobHistoryServer</p>
</li>
<li><p>在hd02上启动resourcemanager服务</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure></div></li>
</ol>
<ul>
<li><p>查看效果</p>
<p>ha01 <a class="link"   target="_blank" rel="noopener" href="http://192.168.179.141:50070/" >http://192.168.179.141:50070/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>ha02 <a class="link"   target="_blank" rel="noopener" href="http://192.168.179.142:50070/" >http://192.168.179.142:50070/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>ha03 <a class="link"   target="_blank" rel="noopener" href="http://192.168.179.143:50070/" >http://192.168.179.143:50070/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
</li>
</ul>
<h5 id="检查集群情况"><a href="#检查集群情况" class="headerlink" title="检查集群情况"></a>检查集群情况</h5><ol>
<li><p>jps 上面服务不能缺少</p>
</li>
<li><p>查看状态</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在hd01上查看服务状态</span></span><br><span class="line">hdfs haadmin -getServiceState nn1 <span class="comment">#active</span></span><br><span class="line">hdfs haadmin -getServiceState nn2 <span class="comment">#standby</span></span><br><span class="line"><span class="comment"># 在hd03上查看resourcemanager状态</span></span><br><span class="line">yarn rmadmin -getServiceState rm1 <span class="comment">#standby</span></span><br><span class="line">yarn rmadmin -getServiceState rm2 <span class="comment">#active</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>检查主备切换</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># kill 掉Namenode主节点 查看Namenode standby节点状态</span></span><br><span class="line"><span class="built_in">kill</span> -9 namenode主节点进程</span><br><span class="line"><span class="comment"># 恢复后重新加入</span></span><br><span class="line">hadoop-daemon.sh start namenode <span class="comment">#启动后也只是standby节点</span></span><br></pre></td></tr></table></figure></div></li>
</ol>
<h5 id="集群关闭"><a href="#集群关闭" class="headerlink" title="集群关闭"></a>集群关闭</h5><div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stop-all.sh</span><br><span class="line">zkServer.sh stop</span><br></pre></td></tr></table></figure></div>

<h5 id="集群二次启动"><a href="#集群二次启动" class="headerlink" title="集群二次启动"></a>集群二次启动</h5><div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#三个都启动</span></span><br><span class="line">zkServer.sh start <span class="comment"># 这个要先开</span></span><br><span class="line"><span class="comment">#在hd01上启动dfs</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"><span class="comment">#在hd03上启动yarn</span></span><br><span class="line">start-yarn.sh</span><br><span class="line"><span class="comment">#在hd02上启动resourcemanager</span></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/13.png"
                      style="zoom:80%;" 
                >

<p>来个第二次开启的脚本</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/bin/sh</span></span><br><span class="line"><span class="comment">#三个都启动</span></span><br><span class="line">zkServer.sh start</span><br><span class="line"><span class="built_in">sleep</span> 0.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取主机名</span></span><br><span class="line">full_hostname=$(hostname)</span><br><span class="line">last_char=<span class="string">&quot;<span class="variable">$&#123;full_hostname:0-1&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$last_char</span> == <span class="string">&quot;1&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">	start-dfs.sh</span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$last_char</span> == <span class="string">&quot;2&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">	yarn-daemon.sh start resourcemanager</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	start-yarn.sh</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>



<h2 id="三-HDFS"><a href="#三-HDFS" class="headerlink" title="三.HDFS"></a>三.HDFS</h2><h3 id="一-介绍"><a href="#一-介绍" class="headerlink" title="(一)介绍"></a>(一)介绍</h3><h4 id="1-HDFS副本机制"><a href="#1-HDFS副本机制" class="headerlink" title="1.HDFS副本机制"></a>1.HDFS副本机制</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/9.png"
                      style="zoom:80%;" 
                >

<h4 id="2-HDFS优缺点"><a href="#2-HDFS优缺点" class="headerlink" title="2.HDFS优缺点"></a>2.HDFS优缺点</h4><ul>
<li>优点<ul>
<li>高容错性</li>
<li>适合大数据处理</li>
<li>可构建在廉价的机器上</li>
</ul>
</li>
<li>缺点<ul>
<li>不适合低延迟数据访问场景</li>
<li>不适合小文件存取场景</li>
<li>不适合并发写入，文件随机求改场景</li>
</ul>
</li>
</ul>
<p>3.HDFS写 文件</p>
<h3 id="二-使用"><a href="#二-使用" class="headerlink" title="(二)使用"></a>(二)使用</h3><h4 id="1-HDFS写-文件"><a href="#1-HDFS写-文件" class="headerlink" title="1.HDFS写 文件"></a>1.HDFS写 文件</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/10.png"
                      style="zoom:80%;" 
                >

<ol>
<li>client向namenode请求地址</li>
<li>client拿着地址向yarn提出写入，提供地址</li>
<li>yarn向datanode存入数据，返回相应的应答</li>
<li>client收到应答后告诉向NameNode</li>
</ol>
<h4 id="2-HDFS读过程"><a href="#2-HDFS读过程" class="headerlink" title="2.HDFS读过程"></a>2.HDFS读过程</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/11.png"
                      style="zoom:80%;" 
                >



<h2 id="四-Hadoop高可用集群"><a href="#四-Hadoop高可用集群" class="headerlink" title="四.Hadoop高可用集群"></a>四.Hadoop高可用集群</h2><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/18.png"
                      style="zoom: 50%;" 
                >

<h3 id="1-ZooKeeper"><a href="#1-ZooKeeper" class="headerlink" title="1.ZooKeeper"></a>1.ZooKeeper</h3><ul>
<li><p>脑裂现象</p>
<p>这边就没这个现象，因为配好了</p>
<p>hadoop 1.x 2.x是要配置重选</p>
<p>3.x中ZooKeeper会在两个主机中选出一个新的</p>
</li>
</ul>
<h3 id="2-Hadoop"><a href="#2-Hadoop" class="headerlink" title="2.Hadoop"></a>2.Hadoop</h3><h4 id="A-使用"><a href="#A-使用" class="headerlink" title="A.使用"></a>A.使用</h4><ul>
<li><p>查看效果</p>
<p>ha01 <a class="link"   target="_blank" rel="noopener" href="http://192.168.179.141:50070/" >http://192.168.179.141:50070/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>ha02 <a class="link"   target="_blank" rel="noopener" href="http://192.168.179.142:50070/" >http://192.168.179.142:50070/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>ha03 <a class="link"   target="_blank" rel="noopener" href="http://192.168.179.143:50070/" >http://192.168.179.143:50070/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
</li>
</ul>
<h5 id="检查集群情况-1"><a href="#检查集群情况-1" class="headerlink" title="检查集群情况"></a>检查集群情况</h5><ol>
<li><p>jps 上面服务不能缺少</p>
</li>
<li><p>查看状态</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在hd01上查看服务状态</span></span><br><span class="line">hdfs haadmin -getServiceState nn1 <span class="comment">#active</span></span><br><span class="line">hdfs haadmin -getServiceState nn2 <span class="comment">#standby</span></span><br><span class="line"><span class="comment"># 在hd03上查看resourcemanager状态</span></span><br><span class="line">yarn rmadmin -getServiceState rm1 <span class="comment">#standby</span></span><br><span class="line">yarn rmadmin -getServiceState rm2 <span class="comment">#active</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>检查主备切换</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># kill 掉Namenode主节点 查看Namenode standby节点状态</span></span><br><span class="line"><span class="built_in">kill</span> -9 namenode主节点进程</span><br><span class="line"><span class="comment"># 恢复后重新加入</span></span><br><span class="line">hadoop-daemon.sh start namenode <span class="comment">#启动后也只是standby节点</span></span><br></pre></td></tr></table></figure></div></li>
</ol>
<h5 id="集群二次启动-1"><a href="#集群二次启动-1" class="headerlink" title="集群二次启动"></a>集群二次启动</h5><div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#三个都启动</span></span><br><span class="line">zkServer.sh start 这个要先开</span><br><span class="line"><span class="comment">#在hd01上启动dfs</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"><span class="comment">#在hd03上启动yarn</span></span><br><span class="line">start-yarn.sh</span><br><span class="line"><span class="comment">#在hd02上启动resourcemanager</span></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure></div>

<ul>
<li>start-dfs.sh启动的是<ul>
<li>NameNode</li>
<li>Secondary NameNode</li>
<li>DataNode</li>
</ul>
</li>
<li>start-dfs.sh启动的是<ul>
<li>ResourceManager</li>
<li>NodeManager</li>
</ul>
</li>
</ul>
<h3 id="3-组成"><a href="#3-组成" class="headerlink" title="3.组成"></a>3.组成</h3><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/8.png"
                      style="zoom:80%;" 
                >

<ul>
<li><p>NameNode相当于DataNode的目录</p>
<p>client得到NameNode中的元数据在去找DN，而不是NN取找DN</p>
</li>
<li><p><strong>NN挂掉了SNN并不会成为主节点，只能作辅助作用</strong>，NN失效了有备用NN而非SNN</p>
</li>
<li><p>&#x2F;opt&#x2F;soft&#x2F;hadoop260&#x2F;dfs&#x2F;namenode_data&#x2F;这里面存储的是namenode的日志文件：fsimage_xxxx</p>
<p>&#x2F;opt&#x2F;soft&#x2F;hadoop260&#x2F;dfs 中的edits是datanode的日志文件</p>
<p>seen_txid要统一</p>
</li>
</ul>
<h2 id="五-MapReduce"><a href="#五-MapReduce" class="headerlink" title="五.MapReduce"></a>五.MapReduce</h2><ul>
<li>程序工程文件夹<code>java/mymr</code></li>
</ul>
<h3 id="一-前期-1"><a href="#一-前期-1" class="headerlink" title="(一)前期"></a>(一)前期</h3><ul>
<li><p>针对大量数据进行计算、统计的引擎框架</p>
</li>
<li><p>数据少没有优势</p>
</li>
<li><p>真正的并行计算</p>
</li>
<li><p>一开始模拟数据调试</p>
</li>
<li><p>我们只要关心程序逻辑，不需要知道这么分布</p>
</li>
<li><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/14.png"
                      style="zoom:80%;" 
                >

<p>分解+聚合</p>
</li>
<li><p>设计思想</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/15.png"
                      style="zoom: 50%;" 
                >
</li>
<li><p>不适用领域</p>
<ul>
<li>难以实时计算</li>
<li>不适合(实时)流式计算</li>
<li>不适合DGA（有向图）计算</li>
</ul>
</li>
<li><p>MapReduce编程规范</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/16.png"
                      style="zoom:80%;" 
                >
</li>
<li><p><strong>开启多reducer节点</strong></p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开启多个reduce任务</span></span><br><span class="line">job.setNumReduceTasks(<span class="number">2</span>);</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><code>MapperJoin</code>  </p>
<p>对于Mapper和Reducer的传递，</p>
<p>对于双表，比如用户和订单，对于大量订单和少量用户</p>
<p>可以把用户信息作为缓存放到订单服务器上，减少数据的拉取(本服务器上的就不用动了)</p>
<p><strong>建议25MB以内的可以传递过来</strong></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/19.png"
                      style="zoom:80%;" 
                >
</li>
<li><p>整体架构</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/20.png" >图片原件<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/20.png"
                      alt="12"  
                >

<ul>
<li><p>过程</p>
<ol>
<li><p>准备行读取器进行逻辑切片，切片过程可以由自己调整切片大小而计算切片数量。但是，由于不会真的直接在128M的地方一刀切，所以可能会出现较大的切片</p>
</li>
<li><p>切片结果，key行偏移量，v为行内容，切成了多少片就有多少mapper任务</p>
<p>提优：一千七八片的话，通过调整切片最大值最小值，将总数提到2000</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切片大小源码 blockSize默认128MB</span></span><br><span class="line"><span class="keyword">protected</span> <span class="type">long</span> <span class="title function_">computeSplitSize</span><span class="params">(<span class="type">long</span> blockSize, <span class="type">long</span> minSize, <span class="type">long</span> maxSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Math.max(minSize, Math.min(maxSize, blockSize));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>mapper处理</p>
</li>
<li><p>读取通过环状缓冲区来读入，用以节省内存，因为前面的切片过程由于不能从中截断会切出过大的片。单个maptask的内存无法直接处理这些数据，这个缓冲区大小为100M，满到80M时，等这条数据读完就溢出写入磁盘。</p>
</li>
<li><p>HashPartitioner分区，在溢出过程中。默认对key进行hash分区，实际可自定义，数量和reducer数量紧密相关</p>
</li>
<li><p>WritableComparator排序，在溢出过程中。默认对key进行ascii的排序，</p>
</li>
<li><p>Combiner进行局部合并，继承的也是Reducer。同时自动归并排序合并成大的内容，因为内部是由多个partition值的。combiner工作的位置和小文件聚合同时进行(这段是透明的)，我们只要关combiner</p>
</li>
<li><p>再传到相应Reducer进行归并。对于是否要reduce，可以看我们需求是否要进行合并。然后是看文件的大小，太小的文件会使过程过于复杂影响效率。</p>
</li>
</ol>
</li>
<li><p>FileInputFormat的过程中会获取前面的一系列参数</p>
<ul>
<li><p>可以直接查看源码</p>
</li>
<li><p>然后再主类中可以加入这条</p>
</li>
</ul>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">job.getConfiguration().setLong(<span class="string">&quot;mapreduce.input.fileinputformat.split.minsize&quot;</span>,<span class="number">10000L</span>);</span><br><span class="line"><span class="comment">// 文件分割最小尺寸10kB一个，最好都是2的多少次方</span></span><br><span class="line">job.getConfiguration().setLong(<span class="string">&quot;mapreduce.input.fileinputformat.split.maxsize&quot;</span>,<span class="number">128000000L</span>);</span><br><span class="line"><span class="comment">// 最大分割</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>FileInputFormat继承InputFormat，里面有分割（getSplits）和读取（createRecordReader）两种要实现</p>
<p>分割的话确定好大小，会往后推直到找到相应符号(比如换行符)</p>
<p>读取默认是行读取器，因此默认Key为LongWritable类型</p>
</li>
</ul>
</li>
<li><p>环状缓冲区</p>
<ul>
<li>切片从头到尾找不到结束符、换行符等等 ，理论128M，但可能远超内存量</li>
<li>用于节省内存</li>
<li>100M用80M，利用类似于双指针法，双指针收尾相接则满，或者直接为0(都是取余的)就满</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="二-Java程序1"><a href="#二-Java程序1" class="headerlink" title="(二)Java程序1"></a>(二)Java程序1</h3><ul>
<li><p>一个文件中单词统计</p>
</li>
<li><p>程序结构</p>
<p>我们要管的就是Map和Reduce</p>
<p>combine和Shuffle之间会比较慢</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/17.png"
                      style="zoom:80%;" 
                >
</li>
<li><p><strong>Hadoop中需要对象比较的原因</strong></p>
<p>Combine到Shuffle的步骤中，通过类似于哈希表的方式计算hash分配到各个服务器中。</p>
</li>
</ul>
<h4 id="1-pom-xml"><a href="#1-pom-xml" class="headerlink" title="1.pom.xml"></a>1.pom.xml</h4><div class="code-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hadoop.version</span>&gt;</span>2.6.0<span class="tag">&lt;/<span class="name">hadoop.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-common --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-client --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-hdfs --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-hdfs<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h4 id="2-WordMapper-java"><a href="#2-WordMapper-java" class="headerlink" title="2.WordMapper.java"></a>2.WordMapper.java</h4><ul>
<li><p>知识</p>
<ul>
<li><p>这样的话要自己实现序列化</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;Long,String,String,Integer&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>用这个就会自动序列化</p>
<p><code>&lt;keyin,valuein,keyout,vlueout&gt;</code></p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text,Text, IntWritable&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>注意，Mapper第一个对于Hadoop而言一般都是LongWritable，都是自动分的行号</strong></p>
</li>
<li><p>用<code>context.write</code>来写入输出值，都要转为相应的格式</p>
</li>
</ul>
</li>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.njupt.mymr.firstmr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分解接收到的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text,Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="type">IntWritable</span> <span class="variable">one</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 将一行数据分割成单词</span></span><br><span class="line">        String[] words = value.toString().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="comment">// 利用for循环向后传递(单词 1)</span></span><br><span class="line">        <span class="keyword">for</span> (String word : words) &#123;</span><br><span class="line">            context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(word),one);<span class="comment">//hello 1, ok 1,hello 1, hadoop 1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>解释</p>
<ul>
<li><code>IntWritable one = new IntWritable(1);</code>放外面节省空间</li>
</ul>
</li>
</ul>
<h4 id="3-WordReduce-java"><a href="#3-WordReduce-java" class="headerlink" title="3.WordReduce.java"></a>3.WordReduce.java</h4><ul>
<li><p>知识</p>
<ul>
<li>用<code>context.write</code>来写入输出值，都要转为相应的格式</li>
</ul>
</li>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.njupt.mymr.firstmr;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line">  <span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">import</span> java.io.IOException;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 聚合统计</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">      <span class="comment">// hello [1,1]</span></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">          <span class="comment">// 统计数组中有多少数字进行相加</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">cnt</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">for</span> (IntWritable iw : values) &#123;</span><br><span class="line">              <span class="comment">//            cnt+=iw.get();</span></span><br><span class="line">              cnt++;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 将统计的结果存放到文件中</span></span><br><span class="line">          context.write(key, <span class="keyword">new</span> <span class="title class_">IntWritable</span>(cnt));</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>解释</p>
<ul>
<li>可以看到reduce方法第二个参数为迭代器，是因为值其实是多个聚合的数组，具体参考图片的Shuffle阶段</li>
</ul>
</li>
</ul>
<h4 id="4-main"><a href="#4-main" class="headerlink" title="4.main"></a>4.main</h4><ul>
<li><p>知识</p>
<ul>
<li><p>包要搞对</p>
<p>FileInputFormat和FileOutputFormat用长的那个包lib的</p>
</li>
</ul>
</li>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.njupt.mymr.firstmr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调用MapReduce框架运行我写的mapper和reducer业务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 开启配置环境</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="comment">// 开启任务</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line">        <span class="comment">// 设置程序的引导类</span></span><br><span class="line">        job.setJarByClass(WordApp.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务</span></span><br><span class="line">        job.setMapperClass(WordMapper.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务的输出类型</span></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">// 设置reducer任务</span></span><br><span class="line">        job.setReducerClass(WordReducer.class);</span><br><span class="line">        <span class="comment">// 设置reducer任务的输出类</span></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">// 设置文件读取路径 FileInputFormat用长的那个包lib的</span></span><br><span class="line">        FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\word.txt&quot;</span>));</span><br><span class="line">        <span class="comment">// 设置统计结果的输出路径 FileOutputFormat用长的那个包lib的 这个文件夹不能存在</span></span><br><span class="line">        FileOutputFormat.setOutputPath(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\wordresult&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//启动程序</span></span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>解释</p>
<ul>
<li><p>执行后会出错，空指针异常</p>
<p>因为windows下没hadoop环境，要配置环境</p>
</li>
</ul>
</li>
<li><p>windows下hadoop环境伪造</p>
<ul>
<li><p>把hadoop的压缩包找到一个地方解压(只要用里面的库)</p>
</li>
<li><p>把winutils.exe放在bin文件夹中</p>
</li>
<li><p>hadoop.dll放到c:&#x2F;Windows&#x2F;System32中</p>
</li>
<li><p>环境变量</p>
<p>新建一个HADOOP_HOME  值为hadoop文件路径</p>
<p>在Path中新加一条%HADOOP_HOME%\bin</p>
</li>
<li><p>重启一下idea</p>
</li>
</ul>
</li>
</ul>
<h3 id="三-Hadoop手动序列化"><a href="#三-Hadoop手动序列化" class="headerlink" title="(三)Hadoop手动序列化"></a>(三)Hadoop手动序列化</h3><ul>
<li><p>序列化和反序列化都要写，要对应好</p>
</li>
<li><p>Hadoop中的变量都要是序列化的，比如Text、IntWritable、LongWritable</p>
<p>如果不用这个，就需要我们手动的去序列化</p>
</li>
<li><p>全部手写</p>
<p><strong>一定要接入<code>Serializable</code>接口</strong></p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String stuname;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> chinese;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> math;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> english;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有参构造、无参构造、get、set</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 序列化</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">st</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zs&quot;</span>, <span class="number">20</span>, <span class="number">88</span>, <span class="number">90</span>, <span class="number">95</span>);</span><br><span class="line">        <span class="comment">// 这个里面是文件</span></span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;e:/Temp/aabbcc&quot;</span>));</span><br><span class="line">        oos.writeObject(st);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 反序列化</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;e:/Temp/aabbcc&quot;</span>));</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> (Student) ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(stu.getStuname()+<span class="string">&quot;...&quot;</span>+stu.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>MapReduce提供自动序列化与比较<code>WritableComparable&lt;T&gt;</code></p>
<p>写就是序列化，读就是反序列化</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">WritableComparable</span>&lt;Student&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> String stuname;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> chinese;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> math;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> english;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 比较</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Student o)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 序列化</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(DataOutput dataOutput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 顺序不能乱，要和属性顺序一模一样</span></span><br><span class="line">        dataOutput.writeUTF(stuname);</span><br><span class="line">        dataOutput.writeInt(age);</span><br><span class="line">        dataOutput.writeInt(chinese);</span><br><span class="line">        dataOutput.writeInt(math);</span><br><span class="line">        dataOutput.writeInt(english);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 反序列化</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFields</span><span class="params">(DataInput dataInput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.stuname=dataInput.readUTF();</span><br><span class="line">        <span class="built_in">this</span>.age = dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.chinese = dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.math = dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.english = dataInput.readInt();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
</ul>
<h3 id="四-Java程序2"><a href="#四-Java程序2" class="headerlink" title="(四)Java程序2"></a>(四)Java程序2</h3><ul>
<li><p>学生成绩行转列</p>
</li>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 实体类</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">WritableComparable</span>&lt;Student&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> String stuname;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> chinese;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> math;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> english;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Student o)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(DataOutput dataOutput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 顺序不能乱，要和属性顺序一模一样</span></span><br><span class="line">        dataOutput.writeUTF(stuname);</span><br><span class="line">        dataOutput.writeInt(age);</span><br><span class="line">        dataOutput.writeInt(chinese);</span><br><span class="line">        dataOutput.writeInt(math);</span><br><span class="line">        dataOutput.writeInt(english);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFields</span><span class="params">(DataInput dataInput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.stuname=dataInput.readUTF();</span><br><span class="line">        <span class="built_in">this</span>.age = dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.chinese = dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.math = dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.english = dataInput.readInt();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 要有set get toString</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text,Text,Student&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, Student&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        String[] infos = value.toString().split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        stu.setStuname(infos[<span class="number">1</span>]);</span><br><span class="line">        stu.setAge(Integer.parseInt(infos[<span class="number">2</span>]));</span><br><span class="line">        <span class="keyword">if</span> (infos[<span class="number">3</span>].equalsIgnoreCase(<span class="string">&quot;chinese&quot;</span>)) &#123;</span><br><span class="line">            stu.setChinese(Integer.parseInt(infos[<span class="number">4</span>]));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (infos[<span class="number">3</span>].equalsIgnoreCase(<span class="string">&quot;math&quot;</span>)) &#123;</span><br><span class="line">            stu.setMath(Integer.parseInt(infos[<span class="number">4</span>]));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            stu.setEnglish(Integer.parseInt(infos[<span class="number">4</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(stu.getStuname()),stu);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Student, Text, NullWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Student&gt; values, Reducer&lt;Text, Student, Text, NullWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">int</span>[] scores = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (Student st : values) &#123;</span><br><span class="line">            <span class="keyword">if</span> (st.getChinese() != <span class="number">0</span>) &#123;</span><br><span class="line">                scores[<span class="number">0</span>]=st.getChinese();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (st.getMath() != <span class="number">0</span>) &#123;</span><br><span class="line">                scores[<span class="number">1</span>] = st.getMath();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                scores[<span class="number">2</span>] = st.getEnglish();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(key+<span class="string">&quot; &quot;</span>+ Arrays.toString(scores)),NullWritable.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 开启配置环境</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="comment">// 开启任务</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line">        <span class="comment">// 设置程序的引导类</span></span><br><span class="line">        job.setJarByClass(StudentApp.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务</span></span><br><span class="line">        job.setMapperClass(StudentMapper.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务的输出类型</span></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(Student.class);</span><br><span class="line">        <span class="comment">// 设置reducer任务</span></span><br><span class="line">        job.setReducerClass(StudentReducer.class);</span><br><span class="line">        <span class="comment">// 设置reducer任务的输出类</span></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(NullWritable.class);</span><br><span class="line">        <span class="comment">// 设置文件读取路径 FileInputFormat用长的那个包lib的</span></span><br><span class="line">        FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\stu.csv&quot;</span>));</span><br><span class="line">        <span class="comment">// 设置统计结果的输出路径 FileOutputFormat用长的那个包lib的</span></span><br><span class="line">        FileOutputFormat.setOutputPath(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\sturesult&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//启动程序</span></span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>程序解释</p>
<p>不要某个输出可以用<code>NullWritable</code></p>
<p>最后要用<code>NullWritable.get()</code>来交付一个空值</p>
<p>自己的类就一定要序列化才能再mapper和reducer里用</p>
</li>
<li><p>程序效果</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1,zs,20,chinese,56</span><br><span class="line">2,zs,20,math,35</span><br><span class="line">3,zs,20,english,33</span><br><span class="line">4,ls,21,chinese,48</span><br><span class="line">5,ls,21,math,77</span><br><span class="line">6,ls,21,english,53</span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls [48, 77, 53]</span><br><span class="line">zs [56, 35, 33]</span><br></pre></td></tr></table></figure></div></li>
</ul>
<h3 id="五-Java程序3"><a href="#五-Java程序3" class="headerlink" title="(五)Java程序3#"></a>(五)Java程序3#</h3><ul>
<li><p>双表查询的内联</p>
</li>
<li><p>用户和用户订单</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1,张三,23</span><br><span class="line">2,李四,534</span><br><span class="line">3,王五,234</span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1,1,苹果,30</span><br><span class="line">2,2,栗子,40</span><br><span class="line">3,3,西瓜,15</span><br><span class="line">4,3,火龙果,80</span><br></pre></td></tr></table></figure></div>


</li>
<li><p>mapper进来的时候，是单纯的上下拼接，一开始进来的key是行数</p>
</li>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustOrder</span> <span class="keyword">implements</span> <span class="title class_">WritableComparable</span>&lt;CustOrder&gt;,Cloneable &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> custid;</span><br><span class="line">    <span class="keyword">private</span> String custname=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> ordid;</span><br><span class="line">    <span class="keyword">private</span> String goodname=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CustOrder <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> (CustOrder)<span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(CustOrder o)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(DataOutput dataOutput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        dataOutput.writeInt(custid);</span><br><span class="line">        dataOutput.writeUTF(custname);</span><br><span class="line">        dataOutput.writeInt(age);</span><br><span class="line">        dataOutput.writeInt(ordid);</span><br><span class="line">        dataOutput.writeUTF(goodname);</span><br><span class="line">        dataOutput.writeDouble(price);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFields</span><span class="params">(DataInput dataInput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.custid=dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.custname=dataInput.readUTF();</span><br><span class="line">        <span class="built_in">this</span>.age=dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.ordid=dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.goodname=dataInput.readUTF();</span><br><span class="line">        <span class="built_in">this</span>.price=dataInput.readDouble();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// toString get set省略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这边按照用户id单纯分一下组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustOrderMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, IntWritable,CustOrder&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, IntWritable, CustOrder&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 分割字符串</span></span><br><span class="line">        String[] infos = value.toString().split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="type">CustOrder</span> <span class="variable">co</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustOrder</span>();</span><br><span class="line">        <span class="comment">// 判断本条数据传入的是用户还是订单</span></span><br><span class="line">        <span class="keyword">if</span> (infos.length == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="comment">// 传入的是一个用户数据</span></span><br><span class="line">            co.setCustid(Integer.parseInt(infos[<span class="number">0</span>]));</span><br><span class="line">            co.setCustname(infos[<span class="number">1</span>]);</span><br><span class="line">            co.setAge(Integer.parseInt(infos[<span class="number">2</span>]));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 传入的是一个订单数据</span></span><br><span class="line">            co.setOrdid(Integer.parseInt(infos[<span class="number">0</span>]));</span><br><span class="line">            co.setCustid(Integer.parseInt(infos[<span class="number">1</span>]));</span><br><span class="line">            co.setGoodname(infos[<span class="number">2</span>]);</span><br><span class="line">            co.setPrice(Double.parseDouble(infos[<span class="number">3</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">IntWritable</span>(co.getCustid()),co);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustOrderReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;IntWritable,CustOrder, Text, NullWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(IntWritable key, Iterable&lt;CustOrder&gt; values, Reducer&lt;IntWritable, CustOrder, Text, NullWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 将迭代器转集合</span></span><br><span class="line">        List&lt;CustOrder&gt; groupLst = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (CustOrder cu : values) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                groupLst.add(cu.clone());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        for (CustOrder cu : values) &#123;</span></span><br><span class="line"><span class="comment">//            groupLst.add(cu);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 找到用户对象信息</span></span><br><span class="line">        <span class="type">CustOrder</span> <span class="variable">cust</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustOrder</span>();</span><br><span class="line">        <span class="keyword">for</span> (CustOrder co:groupLst)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!co.getCustname().equals(<span class="string">&quot;&quot;</span>)) &#123; <span class="comment">// 要用equals否则会出错</span></span><br><span class="line">                cust.setCustid(co.getCustid());</span><br><span class="line">                cust.setCustname(co.getCustname());</span><br><span class="line">                cust.setAge(co.getAge());</span><br><span class="line">                groupLst.remove(co);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关联数据发送到mr上下文</span></span><br><span class="line">        <span class="keyword">for</span> (CustOrder cos : groupLst) &#123;</span><br><span class="line">            <span class="comment">// 将订单信息和用户信息关联起来</span></span><br><span class="line">            cust.setOrdid(cos.getOrdid());</span><br><span class="line">            cust.setGoodname(cos.getGoodname());</span><br><span class="line">            cust.setPrice(cos.getPrice());</span><br><span class="line">            <span class="comment">// 将本数据发送上下文</span></span><br><span class="line">            context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(cust.toString()),NullWritable.get());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustOrderApp</span> &#123;</span><br><span class="line">    <span class="comment">// 递归删除一个文件夹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deleteDirectory</span><span class="params">(File dir)</span> &#123;</span><br><span class="line">        File[] files = dir.listFiles();</span><br><span class="line">        <span class="keyword">if</span> (files != <span class="literal">null</span>) &#123; <span class="comment">//some JVM implementations may return null for empty dirs</span></span><br><span class="line">            <span class="keyword">for</span> (File file : files) &#123;</span><br><span class="line">                <span class="keyword">if</span> (file.isDirectory()) &#123;</span><br><span class="line">                    <span class="comment">// Recursive call</span></span><br><span class="line">                    deleteDirectory(file);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// Delete the file</span></span><br><span class="line">                    file.delete();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// The directory is now empty so now it can be deleted</span></span><br><span class="line">        dir.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 开启配置环境</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="comment">// 开启任务</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line">        <span class="comment">// 设置程序的引导类</span></span><br><span class="line">        job.setJarByClass(CustOrderApp.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务</span></span><br><span class="line">        job.setMapperClass(CustOrderMapper.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务的输出类型</span></span><br><span class="line">        job.setMapOutputKeyClass(IntWritable.class);</span><br><span class="line">        job.setMapOutputValueClass(CustOrder.class);</span><br><span class="line">        <span class="comment">// 设置reducer任务</span></span><br><span class="line">        job.setReducerClass(CustOrderReducer.class);</span><br><span class="line">        <span class="comment">// 设置reducer任务的输出类</span></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(NullWritable.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//有这个文件就删了</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">fi</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorderresult&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(fi.exists())&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CustOrderApp</span>().deleteDirectory(fi);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置文件读取路径 FileInputFormat用长的那个包lib的</span></span><br><span class="line">        FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorder&quot;</span>));</span><br><span class="line">        <span class="comment">// 设置统计结果的输出路径 FileOutputFormat用长的那个包lib的</span></span><br><span class="line">        FileOutputFormat.setOutputPath(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorderresult&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//启动程序</span></span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>解释</p>
<ul>
<li><p>空不能序列化，所以实体类中可以写个””初始化</p>
</li>
<li><p>要小心对象的传入与删除，往往会导致空指针</p>
<p>比如CustOrderReducer中，每次cu地址相同，会导致指向的空间一致，所以导致groupLst中的内容全部相同(这边的values是<code>Iterable&lt;CustOrder&gt; values</code>)</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;CustOrder&gt; groupLst = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (CustOrder cu : values) &#123;</span><br><span class="line">      groupLst.add(cu);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>那么有几种解决方法</p>
<ol>
<li><p>新建一个CustOrder对象，逐个属性复制过去，<code>groupLst.add(新对象)</code></p>
</li>
<li><p>再CustOrder里面实现clone()，<code>groupLst.add(cu.clone())</code></p>
<p>实例对象要实现Cloneable接口才可以让clone()用public</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustOrder</span> <span class="keyword">implements</span> <span class="title class_">WritableComparable</span>&lt;CustOrder&gt;,Cloneable &#123;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CustOrder <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> (CustOrder)<span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustOrderReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;IntWritable,CustOrder, Text, NullWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(IntWritable key, Iterable&lt;CustOrder&gt; values, Reducer&lt;IntWritable, CustOrder, Text, NullWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 将迭代器转集合</span></span><br><span class="line">        List&lt;CustOrder&gt; groupLst = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (CustOrder cu : values) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                groupLst.add(cu.clone());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ....</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//.....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>找不到其他的了&#x2F;(ㄒoㄒ)&#x2F;~~</p>
</li>
</ol>
</li>
<li><p><strong>开启多reducer节点</strong></p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开启多个reduce任务</span></span><br><span class="line">job.setNumReduceTasks(<span class="number">2</span>);</span><br></pre></td></tr></table></figure></div></li>
</ul>
</li>
<li><p>结果</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CustOrder&#123;custid=1, custname=&#x27;张三&#x27;, age=23, ordid=1, goodname=&#x27;苹果&#x27;, price=30.0&#125;</span><br><span class="line">CustOrder&#123;custid=2, custname=&#x27;李四&#x27;, age=534, ordid=2, goodname=&#x27;栗子&#x27;, price=40.0&#125;</span><br><span class="line">CustOrder&#123;custid=3, custname=&#x27;王五&#x27;, age=234, ordid=4, goodname=&#x27;火龙果&#x27;, price=80.0&#125;</span><br><span class="line">CustOrder&#123;custid=3, custname=&#x27;王五&#x27;, age=234, ordid=3, goodname=&#x27;西瓜&#x27;, price=15.0&#125;</span><br></pre></td></tr></table></figure></div></li>
</ul>
<p>(六)Java程序4 MapJoin</p>
<ul>
<li><p>少量数据的如用户，和大量数据的如订单，少量数据要小于25MB</p>
</li>
<li><p>Reduce根本不用，只用Mapper，Mapper兼具了Reducer的功能。ReduceJoin是在Reducer中进行表关联</p>
</li>
<li><p>少量数据直接放到服务器的缓存中，在mapper阶段关联</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将用户文件(小于25M)存放到缓存中</span></span><br><span class="line">job.addCacheFile(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorder\\custs.csv&quot;</span>).toURI());</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>在mapper中要初始化setup加入缓存</p>
<p><code>URI[] uris = context.getCacheFiles();</code></p>
</li>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CO</span> <span class="keyword">implements</span> <span class="title class_">WritableComparable</span>&lt;CustOrder&gt;,Cloneable &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> custid;</span><br><span class="line">    <span class="keyword">private</span> String custname=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> ordid;</span><br><span class="line">    <span class="keyword">private</span> String goodname=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> price;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CustOrder <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> (CustOrder)<span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(CustOrder o)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(DataOutput dataOutput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        dataOutput.writeInt(custid);</span><br><span class="line">        dataOutput.writeUTF(custname);</span><br><span class="line">        dataOutput.writeInt(age);</span><br><span class="line">        dataOutput.writeInt(ordid);</span><br><span class="line">        dataOutput.writeUTF(goodname);</span><br><span class="line">        dataOutput.writeDouble(price);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFields</span><span class="params">(DataInput dataInput)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.custid=dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.custname=dataInput.readUTF();</span><br><span class="line">        <span class="built_in">this</span>.age=dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.ordid=dataInput.readInt();</span><br><span class="line">        <span class="built_in">this</span>.goodname=dataInput.readUTF();</span><br><span class="line">        <span class="built_in">this</span>.price=dataInput.readDouble();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// set get toString</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">COMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text,Text, NullWritable&gt; &#123;</span><br><span class="line">    <span class="comment">// 作为缓存</span></span><br><span class="line">    Map&lt;String,String&gt; cache = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// 服务器启动时运行一次</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">(Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 读缓存中的cust文件 设置相应的数据结构 存放到全局变量中</span></span><br><span class="line">        URI[] uris = context.getCacheFiles();</span><br><span class="line">        <span class="keyword">if</span> (uris != <span class="literal">null</span> &amp;&amp; uris.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 获取缓存文件路径</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> uris[<span class="number">0</span>].getPath();</span><br><span class="line">            <span class="comment">// 读文件</span></span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(path));</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                String[] infos = line.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                cache.put(infos[<span class="number">0</span>],line);</span><br><span class="line">            &#125;</span><br><span class="line">            br.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 获得到的是Order的数据1，1，苹果，30</span></span><br><span class="line">        String[] infos = value.toString().split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> cache.get(infos[<span class="number">1</span>]);</span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(user+<span class="string">&quot;,&quot;</span>+value.toString()),NullWritable.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">COApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 开启配置环境</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="comment">// 开启任务</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line">        <span class="comment">// 设置程序的引导类</span></span><br><span class="line">        job.setJarByClass(COApp.class);</span><br><span class="line">        <span class="comment">// 将用户文件(小于25M)存放到缓存中</span></span><br><span class="line">        job.addCacheFile(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorder\\custs.csv&quot;</span>).toURI());</span><br><span class="line">        <span class="comment">// 设置mapper任务</span></span><br><span class="line">        job.setMapperClass(COMapper.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务的输出类型</span></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(NullWritable.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置文件读取路径 FileInputFormat用长的那个包lib的</span></span><br><span class="line">        FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorder\\orders.csv&quot;</span>));</span><br><span class="line">        <span class="comment">// 设置统计结果的输出路径 FileOutputFormat用长的那个包lib的</span></span><br><span class="line">        FileOutputFormat.setOutputPath(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorderresult&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//启动程序</span></span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
</ul>
<h3 id="六-Java程序4"><a href="#六-Java程序4" class="headerlink" title="(六)Java程序4"></a>(六)Java程序4</h3><ul>
<li><p>MapReduce中所有内容都可以自定义</p>
<ol>
<li><p>这边来自定义中间的<strong>分组Partition部分</strong>，原生的是用hash进行分配reducer，可以自定义分配，这边是按照张、李、其他分</p>
<ul>
<li>自己的类<code>extends Partitioner&lt;T1,T2&gt;</code>mapper的outkey和outvalue</li>
</ul>
<p>返回的0、1、2就是放进哪个文件中</p>
<ul>
<li>主类中要有对应的Reducer数量即为分组数量，然后定义使用自定义分区</li>
</ul>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开启多个reduce任务</span></span><br><span class="line">job.setNumReduceTasks(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用自定义分区</span></span><br><span class="line">job.setPartitionerClass(MyPartitioner.class);</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>自定义<strong>排序Order部分</strong>，默认按键排序，自己重写也按键，但是可以把要排序的一起放到键中。这边按年龄排序</p>
<ul>
<li><p>两个参数就是两个键，return按照-1 0 1来排大小，如果是整数可以直接用<code>Integer.compare(para1,para2)</code></p>
</li>
<li><p>里面其实有很多接口的方法，这边只是其中一个</p>
</li>
<li><p>在主类中要加上如下语句</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置reducer任务</span></span><br><span class="line">job.setReducerClass(CustOrderReducer.class);</span><br></pre></td></tr></table></figure></div></li>
</ul>
</li>
<li><p>自定义<strong>Combiner部分</strong>，比如要聚合的时候算这个姓人的平均值</p>
<ul>
<li><p>虽然实现的是Reducer，但<strong>要和Mapper的输出结果保持一致</strong></p>
<p><code>extends Reducer&lt;mapperOutKey, mapperOutValue,mapperOutKey, mapperOutValue&gt; </code></p>
</li>
<li><p>也可以做排序，但是不是在整个组中，而是在相同的键中排序</p>
</li>
<li><p>在主类中要加入如下语句</p>
</li>
</ul>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置combiner</span></span><br><span class="line">job.setCombinerClass(PartCombiner.class);</span><br></pre></td></tr></table></figure></div></li>
</ol>
</li>
<li><p>多出的东西</p>
<ul>
<li>原本数据</li>
</ul>
</li>
</ul>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">张三,20</span><br><span class="line">李四,30</span><br><span class="line">张无忌,18</span><br><span class="line">张三丰,80</span><br><span class="line">李四光,50</span><br><span class="line">李显龙,24</span><br><span class="line">王五,60</span><br><span class="line">赵六,56</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>程序</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PartMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text,Text, Text&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text,Text&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 分割数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> value.toString().substring(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="comment">//        String[] infos = value.toString().split(&quot;,&quot;);</span></span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(name),value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyPartitioner</span> <span class="keyword">extends</span> <span class="title class_">Partitioner</span>&lt;Text, Text&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getPartition</span><span class="params">(Text text, Text text2, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> text.toString();</span><br><span class="line">        <span class="keyword">if</span>(name.equals(<span class="string">&quot;张&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (name.equals(<span class="string">&quot;李&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PartSortComparator</span> <span class="keyword">extends</span> <span class="title class_">WritableComparator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PartSortComparator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(Text.class,<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(WritableComparable a, WritableComparable b)</span> &#123;</span><br><span class="line">        <span class="type">Text</span> <span class="variable">user1</span> <span class="operator">=</span> (Text)a;   <span class="comment">// a、b都是前面传过来的键</span></span><br><span class="line">        <span class="type">Text</span> <span class="variable">user2</span> <span class="operator">=</span> (Text)b;</span><br><span class="line">        <span class="type">int</span> <span class="variable">user1Age</span> <span class="operator">=</span> Integer.parseInt(user1.toString().split(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">        <span class="type">int</span> <span class="variable">user2Age</span> <span class="operator">=</span> Integer.parseInt(user2.toString().split(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(user1Age, user2Age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PartCombiner</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, Text,Text,Text&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Reducer&lt;Text, Text, Text, Text&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 填充数据到集合</span></span><br><span class="line">        List&lt;String&gt; strlst = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Text user : values) &#123;</span><br><span class="line">            strlst.add(user.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算所有人年龄的平均值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">cnt</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (String us : strlst) &#123;</span><br><span class="line">            cnt+=Integer.parseInt(us.split(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        cnt = cnt / strlst.size();</span><br><span class="line">        <span class="comment">// 对string集合进行排队</span></span><br><span class="line">        Object[] obj = strlst.stream().sorted(<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;String&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(String o1, String o2)</span> &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">age1</span> <span class="operator">=</span> Integer.parseInt(o1.split(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">                <span class="type">int</span> <span class="variable">age2</span> <span class="operator">=</span> Integer.parseInt(o2.split(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">return</span> Integer.compare(age1, age2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).toArray();</span><br><span class="line">        <span class="comment">// 输出数据</span></span><br><span class="line">        <span class="keyword">for</span> (Object ob : obj) &#123;</span><br><span class="line">            context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(ob.toString()+<span class="string">&quot;,avg=&quot;</span>+cnt),<span class="keyword">new</span> <span class="title class_">Text</span>(<span class="string">&quot;&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PartApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 开启配置环境</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="comment">// 开启任务</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line">        <span class="comment">// 设置程序的引导类</span></span><br><span class="line">        job.setJarByClass(PartApp.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务</span></span><br><span class="line">        job.setMapperClass(PartMapper.class);</span><br><span class="line">        <span class="comment">// 设置mapper任务的输出类型</span></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(Text.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开启多个reduce任务</span></span><br><span class="line">        job.setNumReduceTasks(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用自定义分区</span></span><br><span class="line">        job.setPartitionerClass(MyPartitioner.class);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//        // 设置Mapper中的数据排序</span></span><br><span class="line"><span class="comment">//       job.setSortComparatorClass(PartSortComparator.class);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置combiner</span></span><br><span class="line">        job.setCombinerClass(PartCombiner.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置文件读取路径 FileInputFormat用长的那个包lib的</span></span><br><span class="line">        FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\users.csv&quot;</span>));</span><br><span class="line">        <span class="comment">// 设置统计结果的输出路径 FileOutputFormat用长的那个包lib的</span></span><br><span class="line">        FileOutputFormat.setOutputPath(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;E:\\ProgramFile\\BigDataStudy\\data\\mymr\\custorderresult&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//启动程序</span></span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>最终结果</p>
<ul>
<li><p>part-r-00000</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">张无忌,18,avg=39	</span><br><span class="line">张三,20,avg=39	</span><br><span class="line">张三丰,80,avg=39	</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>part-r-00001</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">李显龙,24,avg=34	</span><br><span class="line">李四,30,avg=34	</span><br><span class="line">李四光,50,avg=34	</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>part-r-00002</p>
<p>  可以看到，不同姓(键)下的并没有升序排序</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">王五,60,avg=60	</span><br><span class="line">赵六,56,avg=56	</span><br></pre></td></tr></table></figure></div></li>
</ul>
</li>
</ul>
<h2 id="六-Yarn"><a href="#六-Yarn" class="headerlink" title="六.Yarn"></a>六.Yarn</h2><h3 id="（一）前期"><a href="#（一）前期" class="headerlink" title="（一）前期"></a>（一）前期</h3><ul>
<li><p>分布式资源调度管理框架</p>
<p>（Yet Another Resource Negotiator）</p>
</li>
<li><p>历史</p>
<p>1.x中没有，mapreduce自己调度</p>
<p>2.x中开始出现</p>
</li>
</ul>
<h3 id="（二）Yarn内容"><a href="#（二）Yarn内容" class="headerlink" title="（二）Yarn内容"></a>（二）Yarn内容</h3><h4 id="1-基本架构核心组件总体"><a href="#1-基本架构核心组件总体" class="headerlink" title="1.基本架构核心组件总体"></a>1.基本架构核心组件总体</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/21.png"
                      style="zoom:80%;" 
                >

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/22.png"
                      style="zoom: 50%;" 
                >

<ul>
<li><p>ApplicationMastper</p>
<p>相当于是做任务的主体，根据RM来调度空余的资源来形成Container。最后结果直接给client而不用交付RM</p>
</li>
<li><p>Container</p>
<p>容器，开辟空间和内存来做事。AM首先在自己的机器上开辟，不够根据RM调度，使用别人的资源来构成新Container</p>
</li>
</ul>
<h4 id="2-ResourceManager"><a href="#2-ResourceManager" class="headerlink" title="2.ResourceManager"></a>2.ResourceManager</h4><ul>
<li>ResourceManager<strong>组成</strong><ul>
<li>ResourceScheduler-&gt;资源调度器，根据节点的容量队列情况，为应用程序分配资源</li>
<li>Application Manager-&gt;应用程序管理器，负责接受Client端传输的job请求</li>
</ul>
</li>
<li>ResourceManager<strong>功能</strong><ul>
<li>处理客户端请求</li>
<li>监控NodeManager</li>
<li>启动和监控ApplicationMaster，进行必要的重启</li>
<li>整个系统的资源分配和调度</li>
</ul>
</li>
</ul>
<h4 id="3-NodeManager"><a href="#3-NodeManager" class="headerlink" title="3.NodeManager"></a>3.NodeManager</h4><ul>
<li><p>NodeManager功能</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/23.png"
                      style="zoom: 50%;" 
                ></li>
</ul>
<h4 id="4-ApplicationMaster"><a href="#4-ApplicationMaster" class="headerlink" title="4.ApplicationMaster"></a>4.ApplicationMaster</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/24.png"
                      style="zoom: 50%;" 
                >

<h4 id="5-Container"><a href="#5-Container" class="headerlink" title="5.Container"></a>5.Container</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/25.png"
                      style="zoom: 50%;" 
                >

<h4 id="6-YARN工作原理"><a href="#6-YARN工作原理" class="headerlink" title="6.YARN工作原理"></a>6.<a class="link"   target="_blank" rel="noopener" href="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/26.png" >YARN工作原理<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/26.png"
                      style="zoom: 100%;" 
                >

<ul>
<li>不同任务，容器也不同</li>
</ul>
<h4 id="7-YARN的资源调度器"><a href="#7-YARN的资源调度器" class="headerlink" title="7.YARN的资源调度器"></a>7.YARN的资源调度器</h4><ul>
<li><p>目前Hadoop作业调度器有三种</p>
<ul>
<li><p>FIFO:先进先出调度器</p>
</li>
<li><p>Capacity Scheduler:容量调度器</p>
<p>根据程序的优先级和需求，就调更多资源给它</p>
</li>
<li><p>Fair Scheduler:公平调度器</p>
<p>所有程序和公平分配资源</p>
</li>
</ul>
</li>
<li><p>默认的作业调度器可以在yarn-default.xml文件中查看，属性如下</p>
<ul>
<li>yarn.resourcemanagerscheduler.class</li>
<li>Hadoop版本2.6.0-cdh5.14.2的默认调度器是公平调度器</li>
</ul>
</li>
</ul>
<h3 id="（三）任务提交"><a href="#（三）任务提交" class="headerlink" title="（三）任务提交"></a>（三）任务提交</h3><ol>
<li><p>MapReduceJava项目写好</p>
</li>
<li><p>上传数据文件到所需目录</p>
</li>
<li><p>改代码地址，&#x2F;&#x2F;&#x2F;是本地地址</p>
<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;file:///opt/testdata/users.csv&quot;</span>));</span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;hdfs://192.168.179.139:9000/mydemo/users.csv&quot;</span>));</span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FileInputFormat.setInputPaths(job,<span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">0</span>]));</span><br><span class="line"><span class="comment">// 这种就要命令行传值</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>项目打包，瘦包（不需要包依赖）因为放到hadoop环境下，本来就有</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/Chary/articles/18096225" >胖瘦包<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>这边直接打包，胖包方法是改build中的内容，网上有</p>
</li>
<li><p>运行</p>
<p><code>hadoop jar jar包包路径 主类全限定名 [args的传入值,...]</code></p>
<ul>
<li>用args传入地址的时候<code>file:///opt/testdata/users.csv /opt/testdata/res/five</code>第一个一定要用file:&#x2F;&#x2F; 第二个不一定</li>
<li>hdfs:&#x2F;&#x2F;192.168.179.139:9000&#x2F;mydemo&#x2F;users.csv</li>
</ul>
</li>
</ol>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://sabthever.github.io/Pictures1/Blog_Base_Resouces/bigdata/12.png"
                      style="zoom:50%;" 
                >

<h4 id="1-大量小文件存储进入Hadoop"><a href="#1-大量小文件存储进入Hadoop" class="headerlink" title="1.大量小文件存储进入Hadoop"></a>1.大量小文件存储进入Hadoop</h4><ul>
<li><p>不适合小文件原因是单个的文件给了较大的空间，机械硬盘一般用128MB</p>
<p>hadoop2默认块大小就是128Mb</p>
</li>
<li><p>小文件合成大文件 （一般是同样文件格式的、结构化的数据）</p>
<p>用<code>hadoop archive</code>归档</p>
<ol>
<li><p>先把小文件上传</p>
<p>一开始&#x2F;mydemo要有建立好</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -put /opt/testdata/* /mydemo</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>开启压缩</p>
<p>ma.har名字可以改，但后缀名一定要是.har</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop archive -archiveName ma.har -p /mydemo /mydemo1</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>查看归档的文件</p>
<p>hadoop dfs和hdfs dfs没什么显著区别</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">cat</span> /mydemo1/ma.har/part-0</span><br></pre></td></tr></table></figure></div></li>
</ol>
</li>
</ul>
<h4 id="2-Hadoop版本区别"><a href="#2-Hadoop版本区别" class="headerlink" title="2.Hadoop版本区别"></a>2.Hadoop版本区别</h4><ul>
<li>1和2，1没有yarn，2有</li>
<li>2和3，2只有两个NameNode，但是3可以有多个NameNode</li>
</ul>
<h4 id="3-HDFS有哪些角色和功能"><a href="#3-HDFS有哪些角色和功能" class="headerlink" title="3.HDFS有哪些角色和功能"></a>3.HDFS有哪些角色和功能</h4><ul>
<li><p>NameNode</p>
<p>存储文件元数据</p>
</li>
<li><p>DataNode</p>
<p>存储数据</p>
</li>
<li><p>SecondaryNameNode</p>
<p>作为NN的辅助，帮助数据持久化，<strong>单机中没有</strong></p>
</li>
<li><p>ResourseManager</p>
<p>yarn节点，调度</p>
</li>
<li><p>NodeManager</p>
<p>作为yarn的备用节点</p>
</li>
</ul>
<h4 id="4-HDFS副本存放策略"><a href="#4-HDFS副本存放策略" class="headerlink" title="4.HDFS副本存放策略"></a>4.HDFS副本存放策略</h4><ul>
<li>三台机器，两台同一机架上，还有一台在其他机架上</li>
</ul>
<h4 id="5-HDFS读写流程"><a href="#5-HDFS读写流程" class="headerlink" title="5.HDFS读写流程"></a>5.HDFS读写流程</h4><h4 id="6-MapReduce的过程"><a href="#6-MapReduce的过程" class="headerlink" title="6.MapReduce的过程"></a>6.MapReduce的过程</h4><h4 id="7-Hadoop使用的版本"><a href="#7-Hadoop使用的版本" class="headerlink" title="7.Hadoop使用的版本"></a>7.Hadoop使用的版本</h4><h4 id="8-Hive数据倾斜"><a href="#8-Hive数据倾斜" class="headerlink" title="8.Hive数据倾斜"></a>8.Hive数据倾斜</h4><h1 id="小脚本呢"><a href="#小脚本呢" class="headerlink" title="小脚本呢"></a>小脚本呢</h1><h3 id="1-hadoop单机启动"><a href="#1-hadoop单机启动" class="headerlink" title="1.hadoop单机启动"></a>1.hadoop单机启动</h3><div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 五个节点+hive前后+zeppelin</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="built_in">nohup</span> hive --service metastore &amp;</span><br><span class="line"><span class="built_in">nohup</span> hive --service hiveserver2 &amp;</span><br><span class="line">zeppelin-daemon.sh start</span><br></pre></td></tr></table></figure></div>

<h3 id="2-hadoop单机关闭"><a href="#2-hadoop单机关闭" class="headerlink" title="2.hadoop单机关闭"></a>2.hadoop单机关闭</h3><div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">zeppelin-daemon.sh stop</span><br><span class="line">PID=$(jps -l| grep -i RunJar| awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">id</span> <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;PID[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">kill</span> -9 <span class="variable">$id</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">stop-all.sh</span><br><span class="line">jps</span><br></pre></td></tr></table></figure></div>

<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> 大数据学习笔记1-Hadoop</li>
        <li><strong>作者:</strong> Sabthever</li>
        <li><strong>创建于
                :</strong> 2025-01-11 09:28:34</li>
        
            <li>
                <strong>更新于
                    :</strong> 2025-09-11 14:25:10
            </li>
        
        <li>
            <strong>链接:</strong> https://sabthever.cn/2025/01/11/technology/bigdata/Hadoop1/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/Hadoop/">#Hadoop</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/Bigdata/">#Bigdata</a>&nbsp;
			</li>
			
		</ul>
		

		
  <div class="recommended-article px-2 sm:px-6 md:px-8">
   <div class="recommended-desktop">
    <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>推荐阅读</span>
    </div>
    <div class="recommended-article-group"><a class="recommended-article-item" href="/2025/02/17/technology/bigdata/Hadoop2-Hive-Hbase/" title="大数据学习笔记2-Hive、Hbase" rel="bookmark">
  <img src="/images/wallhaven-wqery6-light.webp" alt="大数据学习笔记2-Hive、Hbase" class="!max-w-none">
  <span class="title">大数据学习笔记2-Hive、Hbase</span>
</a><a class="recommended-article-item" href="/2025/07/08/technology/bigdata/Hadoop4-Spark/" title="大数据学习笔记4-Spark" rel="bookmark">
  <img src="/images/wallhaven-wqery6-light.webp" alt="大数据学习笔记4-Spark" class="!max-w-none">
  <span class="title">大数据学习笔记4-Spark</span>
</a><a class="recommended-article-item" href="/2025/09/11/technology/bigdata/Hadoop5-%E7%A6%BB%E7%BA%BF%E9%A1%B9%E7%9B%AE/" title="大数据学习笔记5-离线项目学习" rel="bookmark">
  <img src="/images/wallhaven-wqery6-light.webp" alt="大数据学习笔记5-离线项目学习" class="!max-w-none">
  <span class="title">大数据学习笔记5-离线项目学习</span>
</a></div>
   </div>
   <div class="recommended-mobile">
   <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>推荐阅读</span>
   </div>
   <div class="recommended-article-group"><a class="recommended-article-item" href="/2025/02/17/technology/bigdata/Hadoop2-Hive-Hbase/" title="大数据学习笔记2-Hive、Hbase" rel="bookmark">
  <img src="/images/wallhaven-wqery6-light.webp" alt="大数据学习笔记2-Hive、Hbase" class="!max-w-none">
  <span class="title">大数据学习笔记2-Hive、Hbase</span>
</a><a class="recommended-article-item" href="/2025/07/08/technology/bigdata/Hadoop4-Spark/" title="大数据学习笔记4-Spark" rel="bookmark">
  <img src="/images/wallhaven-wqery6-light.webp" alt="大数据学习笔记4-Spark" class="!max-w-none">
  <span class="title">大数据学习笔记4-Spark</span>
</a></div>
   </div>
  </div>

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/01/15/technology/java/Mybatis%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">Mybatis一对多嵌套查询</span>
						<span class="post-nav-item">上一篇</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/01/08/technology/java/%E4%B8%8B%E9%92%BB%E8%A1%A8%E5%AF%BC%E5%87%BA%E4%B8%BAExcel/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">下钻表导出为Excel</span>
						<span class="post-nav-item">下一篇</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">目录</div>
		<div class="page-title">大数据学习笔记1-Hadoop</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Hadoop1"><span class="nav-text">Hadoop1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-%E5%89%8D%E6%9C%9F"><span class="nav-text">一.前期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-Hadoop%E6%9E%B6%E6%9E%84"><span class="nav-text">二.Hadoop架构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">(一)环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-%E5%8D%95%E6%9C%BA%E9%85%8D%E7%BD%AE"><span class="nav-text">A.单机配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%92%8Capi"><span class="nav-text">使用和api</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-%E9%AB%98%E5%8F%AF%E7%94%A8hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA"><span class="nav-text">B.高可用hadoop集群搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2"><span class="nav-text">集群部署</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E9%9B%86%E7%BE%A4"><span class="nav-text">启动集群</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E9%9B%86%E7%BE%A4%E6%83%85%E5%86%B5"><span class="nav-text">检查集群情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E5%85%B3%E9%97%AD"><span class="nav-text">集群关闭</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E4%BA%8C%E6%AC%A1%E5%90%AF%E5%8A%A8"><span class="nav-text">集群二次启动</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-HDFS"><span class="nav-text">三.HDFS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80-%E4%BB%8B%E7%BB%8D"><span class="nav-text">(一)介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-HDFS%E5%89%AF%E6%9C%AC%E6%9C%BA%E5%88%B6"><span class="nav-text">1.HDFS副本机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-HDFS%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">2.HDFS优缺点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C-%E4%BD%BF%E7%94%A8"><span class="nav-text">(二)使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-HDFS%E5%86%99-%E6%96%87%E4%BB%B6"><span class="nav-text">1.HDFS写 文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-HDFS%E8%AF%BB%E8%BF%87%E7%A8%8B"><span class="nav-text">2.HDFS读过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-Hadoop%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4"><span class="nav-text">四.Hadoop高可用集群</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-ZooKeeper"><span class="nav-text">1.ZooKeeper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Hadoop"><span class="nav-text">2.Hadoop</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-%E4%BD%BF%E7%94%A8"><span class="nav-text">A.使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E9%9B%86%E7%BE%A4%E6%83%85%E5%86%B5-1"><span class="nav-text">检查集群情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E4%BA%8C%E6%AC%A1%E5%90%AF%E5%8A%A8-1"><span class="nav-text">集群二次启动</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%BB%84%E6%88%90"><span class="nav-text">3.组成</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94-MapReduce"><span class="nav-text">五.MapReduce</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80-%E5%89%8D%E6%9C%9F-1"><span class="nav-text">(一)前期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C-Java%E7%A8%8B%E5%BA%8F1"><span class="nav-text">(二)Java程序1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-pom-xml"><span class="nav-text">1.pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-WordMapper-java"><span class="nav-text">2.WordMapper.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-WordReduce-java"><span class="nav-text">3.WordReduce.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-main"><span class="nav-text">4.main</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89-Hadoop%E6%89%8B%E5%8A%A8%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-text">(三)Hadoop手动序列化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B-Java%E7%A8%8B%E5%BA%8F2"><span class="nav-text">(四)Java程序2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94-Java%E7%A8%8B%E5%BA%8F3"><span class="nav-text">(五)Java程序3#</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD-Java%E7%A8%8B%E5%BA%8F4"><span class="nav-text">(六)Java程序4</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD-Yarn"><span class="nav-text">六.Yarn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%89%8D%E6%9C%9F"><span class="nav-text">（一）前期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Yarn%E5%86%85%E5%AE%B9"><span class="nav-text">（二）Yarn内容</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E6%80%BB%E4%BD%93"><span class="nav-text">1.基本架构核心组件总体</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-ResourceManager"><span class="nav-text">2.ResourceManager</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-NodeManager"><span class="nav-text">3.NodeManager</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-ApplicationMaster"><span class="nav-text">4.ApplicationMaster</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-Container"><span class="nav-text">5.Container</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-YARN%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">6.YARN工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-YARN%E7%9A%84%E8%B5%84%E6%BA%90%E8%B0%83%E5%BA%A6%E5%99%A8"><span class="nav-text">7.YARN的资源调度器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E4%BB%BB%E5%8A%A1%E6%8F%90%E4%BA%A4"><span class="nav-text">（三）任务提交</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%97%AE%E9%A2%98"><span class="nav-text">问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%A4%A7%E9%87%8F%E5%B0%8F%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E8%BF%9B%E5%85%A5Hadoop"><span class="nav-text">1.大量小文件存储进入Hadoop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Hadoop%E7%89%88%E6%9C%AC%E5%8C%BA%E5%88%AB"><span class="nav-text">2.Hadoop版本区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-HDFS%E6%9C%89%E5%93%AA%E4%BA%9B%E8%A7%92%E8%89%B2%E5%92%8C%E5%8A%9F%E8%83%BD"><span class="nav-text">3.HDFS有哪些角色和功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-HDFS%E5%89%AF%E6%9C%AC%E5%AD%98%E6%94%BE%E7%AD%96%E7%95%A5"><span class="nav-text">4.HDFS副本存放策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-HDFS%E8%AF%BB%E5%86%99%E6%B5%81%E7%A8%8B"><span class="nav-text">5.HDFS读写流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-MapReduce%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="nav-text">6.MapReduce的过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-Hadoop%E4%BD%BF%E7%94%A8%E7%9A%84%E7%89%88%E6%9C%AC"><span class="nav-text">7.Hadoop使用的版本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-Hive%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C"><span class="nav-text">8.Hive数据倾斜</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%8F%E8%84%9A%E6%9C%AC%E5%91%A2"><span class="nav-text">小脚本呢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-hadoop%E5%8D%95%E6%9C%BA%E5%90%AF%E5%8A%A8"><span class="nav-text">1.hadoop单机启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-hadoop%E5%8D%95%E6%9C%BA%E5%85%B3%E9%97%AD"><span class="nav-text">2.hadoop单机关闭</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3"><span class="nav-text">3.</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%80%E5%90%8E"><span class="nav-text">最后</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2024</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Sabthever</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共撰写了 33 篇文章
                    </span>
                    
                        <span>
                            共 85.9k 字
                        </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            <div class="customize-info my-1">本站所有内容完全免费！不得将本站内容用于商业或者非法用途！</div>
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="站内搜索您需要的内容..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>






    
<script src="/js/build/libs/minimasonry.min.js"></script>

    
<script src="/js/build/plugins/masonry.js" type="module"></script>




    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





    
<script src="/js/build/layouts/bookmarkNav.js" type="module"></script>


	
</body>

</html>